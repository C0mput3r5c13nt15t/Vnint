"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6439],{3666:(Pe,O,c)=>{c.r(O),c.d(O,{EditProjectPageModule:()=>de});var P=c(6019),m=c(9133),q=c(4522),s=c(6990),v=c(6431),A=c(6952),S=(Math.pow(10,8),36e5);function C(i,o){if(o.length<i)throw new TypeError(i+" argument"+(i>1?"s":"")+" required, but only "+o.length+" present")}function M(i){if(null===i||!0===i||!1===i)return NaN;var o=Number(i);return isNaN(o)?o:o<0?Math.ceil(o):Math.floor(o)}function x(i,o){C(1,arguments);var t=o||{},r=null==t.additionalDigits?2:M(t.additionalDigits);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof i&&"[object String]"!==Object.prototype.toString.call(i))return new Date(NaN);var a,n=y(i);if(n.date){var l=w(n.date,r);a=F(l.restDateString,l.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);var p,u=a.getTime(),d=0;if(n.time&&(d=Y(n.time),isNaN(d)))return new Date(NaN);if(!n.timezone){var g=new Date(u+d),Z=new Date(0);return Z.setFullYear(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()),Z.setHours(g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds()),Z}return p=k(n.timezone),isNaN(p)?new Date(NaN):new Date(u+d+p)}var h={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},b=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,L=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,J=/^([+-])(\d{2})(?::?(\d{2}))?$/;function y(i){var r,o={},t=i.split(h.dateTimeDelimiter);if(t.length>2)return o;if(/:/.test(t[0])?r=t[0]:(o.date=t[0],r=t[1],h.timeZoneDelimiter.test(o.date)&&(o.date=i.split(h.timeZoneDelimiter)[0],r=i.substr(o.date.length,i.length))),r){var n=h.timezone.exec(r);n?(o.time=r.replace(n[1],""),o.timezone=n[1]):o.time=r}return o}function w(i,o){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+o)+"})|(\\d{2}|[+-]\\d{"+(2+o)+"})$)"),r=i.match(t);if(!r)return{year:NaN,restDateString:""};var n=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:null===a?n:100*a,restDateString:i.slice((r[1]||r[2]).length)}}function F(i,o){if(null===o)return new Date(NaN);var t=i.match(b);if(!t)return new Date(NaN);var r=!!t[4],n=T(t[1]),a=T(t[2])-1,l=T(t[3]),u=T(t[4]),d=T(t[5])-1;if(r)return function(i,o,t){return o>=1&&o<=53&&t>=0&&t<=6}(0,u,d)?function(i,o,t){var r=new Date(0);r.setUTCFullYear(i,0,4);var a=7*(o-1)+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}(o,u,d):new Date(NaN);var p=new Date(0);return function(i,o,t){return o>=0&&o<=11&&t>=1&&t<=(G[o]||(U(i)?29:28))}(o,a,l)&&function(i,o){return o>=1&&o<=(U(i)?366:365)}(o,n)?(p.setUTCFullYear(o,a,Math.max(n,l)),p):new Date(NaN)}function T(i){return i?parseInt(i):1}function Y(i){var o=i.match(L);if(!o)return NaN;var t=E(o[1]),r=E(o[2]),n=E(o[3]);return function(i,o,t){return 24===i?0===o&&0===t:t>=0&&t<60&&o>=0&&o<60&&i>=0&&i<25}(t,r,n)?t*S+6e4*r+1e3*n:NaN}function E(i){return i&&parseFloat(i.replace(",","."))||0}function k(i){if("Z"===i)return 0;var o=i.match(J);if(!o)return 0;var t="+"===o[1]?-1:1,r=parseInt(o[2]),n=o[3]&&parseInt(o[3])||0;return function(i,o){return o>=0&&o<=59}(0,n)?t*(r*S+6e4*n):NaN}var G=[31,null,31,30,31,30,31,31,30,31,30,31];function U(i){return i%400==0||i%4==0&&i%100!=0}function X(i){C(1,arguments);var o=Object.prototype.toString.call(i);return i instanceof Date||"object"==typeof i&&"[object Date]"===o?new Date(i.getTime()):"number"==typeof i||"[object Number]"===o?new Date(i):(("string"==typeof i||"[object String]"===o)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function f(i,o){for(var t=i<0?"-":"",r=Math.abs(i).toString();r.length<o;)r="0"+r;return t+r}function D(i,o){C(1,arguments);var t=X(i);if(isNaN(t.getTime()))throw new RangeError("Invalid time value");var r=null!=o&&o.format?String(o.format):"extended",n=null!=o&&o.representation?String(o.representation):"complete";if("extended"!==r&&"basic"!==r)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==n&&"time"!==n&&"complete"!==n)throw new RangeError("representation must be 'date', 'time', or 'complete'");var a="",l="",u="extended"===r?"-":"",d="extended"===r?":":"";if("time"!==n){var p=f(t.getDate(),2),g=f(t.getMonth()+1,2),Z=f(t.getFullYear(),4);a="".concat(Z).concat(u).concat(g).concat(u).concat(p)}if("date"!==n){var N=t.getTimezoneOffset();if(0!==N){var _=Math.abs(N),ue=f(Math.floor(_/60),2),ge=f(_%60,2),fe=N<0?"+":"-";l="".concat(fe).concat(ue,":").concat(ge)}else l="Z";var pe=f(t.getHours(),2),Te=f(t.getMinutes(),2),Ze=f(t.getSeconds(),2),ve=""===a?"":"T",he=[pe,Te,Ze].join(d);a="".concat(a).concat(ve).concat(he).concat(l)}return a}var e=c(3245),K=c(1856),V=c(9290),ee=c(5729),re=c(2677),te=c(6733),ie=c(1516),oe=c(1750);function ne(i,o){if(1&i&&(e.TgZ(0,"ion-select-option",23),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.s9C("value",t.key),e.xp6(1),e.Oqu(t.value)}}const j=function(){return{standalone:!0}};function ae(i,o){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ion-col",24),e.TgZ(2,"ion-card",1),e.TgZ(3,"ion-card-content"),e.TgZ(4,"ion-datetime",25),e.NdJ("ngModelChange",function(n){return e.CHM(t).$implicit.from=n}),e.ALo(5,"translate"),e.ALo(6,"translate"),e.ALo(7,"translate"),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"ion-datetime",25),e.NdJ("ngModelChange",function(n){return e.CHM(t).$implicit.until=n}),e.ALo(10,"translate"),e.ALo(11,"translate"),e.ALo(12,"translate"),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.TgZ(14,"div",21),e.TgZ(15,"ion-button",26),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().deleteTimeframe(a)}),e._uU(16,"delete"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&i){const t=o.$implicit;e.xp6(4),e.s9C("doneText",e.lcZ(7,16,"GENERAL.POPUPS.done")),e.s9C("cancelText",e.lcZ(8,18,"GENERAL.POPUPS.cancel")),e.Q6J("hourCycle",e.lcZ(5,12,"GENERAL.hourCycle"))("locale",e.lcZ(6,14,"GENERAL.locale"))("ngModel",t.from)("ngModelOptions",e.DdM(28,j)),e.xp6(5),e.s9C("doneText",e.lcZ(12,24,"GENERAL.POPUPS.done")),e.s9C("cancelText",e.lcZ(13,26,"GENERAL.POPUPS.cancel")),e.Q6J("hourCycle",e.lcZ(10,20,"GENERAL.hourCycle"))("locale",e.lcZ(11,22,"GENERAL.locale"))("ngModel",t.until)("ngModelOptions",e.DdM(29,j))}}const se=[{path:"",component:(()=>{class i{constructor(t,r,n,a,l,u,d){this.projectService=t,this.timeframeService=r,this.formBuilder=n,this.router=a,this.errorService=l,this.translate=u,this.alertService=d,this.isProcessed=!1,this.timeframes=[],this.deleteTimeframes=[]}ngOnInit(){this.editProjectForm=this.formBuilder.group({topic:["",m.kI.required],title:["",m.kI.required],image:null,description:["",m.kI.required],cost:["",m.kI.required],min_grade:["",m.kI.required],max_grade:["",m.kI.required],min_participants:["",m.kI.required],max_participants:["",m.kI.required]})}ionViewWillEnter(){this.isProcessed=!1,this.getProject()}get errorControl(){return this.editProjectForm.controls}getProject(){this.projectService.getAssociatedProject().subscribe({error:t=>{this.errorService.errorOccurred.emit(t)},next:t=>{const r=t;for(const n of r.project.timeframes){const a=new Date(x(n.from).getTime());a.setHours(a.getHours()-2),n.from=D(a);const l=new Date(x(n.until).getTime());l.setHours(l.getHours()-2),n.until=D(l)}this.editProjectForm.patchValue(r.project),r.project.timeframes&&(this.timeframes=r.project.timeframes)}})}editProject(){!this.isProcessed&&this.editProjectForm.valid&&(this.isProcessed=!0,this.updateProject(),this.timeframes.forEach(t=>{t.id?this.timeframeService.updateTimeframe(t).subscribe({error:r=>{if("The given data was invalid."==r.error.message)for(const n in r.error.errors)for(const a in r.error.errors[n])this.alertService.alert("danger",this.translate.instant("ACTIONS.EDIT_PROJECT.title"),r.error.errors[n][a],"close");else"missingPermissions"==r.error.message?this.alertService.alert("danger",this.translate.instant("GENERAL.ERRORS.missingPermissions"),"","lock-closed"):this.errorService.errorOccurred.emit(r)}}):this.timeframeService.createTimeframe(t).subscribe({error:r=>{if("The given data was invalid."==r.error.message)for(const n in r.error.errors)for(const a in r.error.errors[n])this.alertService.alert("danger",this.translate.instant("ACTIONS.EDIT_PROJECT.title"),r.error.errors[n][a],"close");else"missingPermissions"==r.error.message?this.alertService.alert("danger",this.translate.instant("GENERAL.ERRORS.missingPermissions"),"","lock-closed"):this.errorService.errorOccurred.emit(r)}})}),this.deleteTimeframes.forEach(t=>{this.timeframeService.deleteTimeframe(t.id).subscribe({error:r=>{if("The given data was invalid."==r.error.message)for(const n in r.error.errors)for(const a in r.error.errors[n])this.alertService.alert("danger",this.translate.instant("ACTIONS.EDIT_PROJECT.title"),r.error.errors[n][a],"close");else"missingPermissions"==r.error.message?this.alertService.alert("danger",this.translate.instant("GENERAL.ERRORS.missingPermissions"),"","lock-closed"):this.errorService.errorOccurred.emit(r)}})}))}updateProject(){this.projectService.updateProject(this.editProjectForm.value).subscribe({error:t=>{if("The given data was invalid."==t.error.message)for(const r in t.error.errors){const n=[];for(const a in t.error.errors[r])n.push({[t.error.errors[r][a]]:!0});this.editProjectForm.controls[r].setErrors(n)}else"missingPermissions"==t.error.message?this.alertService.alert("danger",this.translate.instant("GENERAL.ERRORS.missingPermissions"),"","lock-closed"):this.errorService.errorOccurred.emit(t);this.isProcessed=!1},next:t=>{const r=t;this.alertService.alert("success",this.translate.instant("ACTIONS.EDIT_PROJECT.title"),r.message,"checkmark")},complete:()=>{this.editProjectForm.reset(),this.isProcessed=!1,this.router.navigate(["/manage-project"])}})}addTimeframe(){this.timeframes.push({from:null,until:null})}deleteTimeframe(t){t.id?(this.deleteTimeframes.push(t),this.timeframes=this.timeframes.filter(r=>r.id!=t.id)):this.timeframes=this.timeframes.filter(r=>r!=t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(K.Y),e.Y36(V.h),e.Y36(m.qu),e.Y36(A.F0),e.Y36(ee.T),e.Y36(v.sK),e.Y36(re.c))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-project"]],decls:92,vars:60,consts:[[3,"title"],["color","light"],[1,"inside-card-grid"],[3,"formGroup","ngSubmit"],["formControlName","topic",3,"okText","cancelText"],[3,"value",4,"ngFor","ngForOf"],["formControlName","title","type","text",3,"placeholder"],[3,"errors"],["formControlName","description","type","text","rows","7",3,"placeholder"],["position","floating"],["formControlName","cost","type","text"],["lines","none","color","light"],[1,"addTimeframeCards"],[4,"ngFor","ngForOf"],["horizontal","center","vertical","center","slot","fixed"],["color","light",3,"click"],["name","add"],["formControlName","min_grade","type","text"],["formControlName","max_grade","type","text"],["formControlName","min_participants","type","number"],["formControlName","max_participants","type","number"],[1,"ion-padding"],["color","primary","expand","block","type","submit",1,"ion-no-margin",3,"disabled"],[3,"value"],["sizeXl","6","sizeLg","6","sizeMd","12","sizeSm","12","sizeXs","12"],["minuteValues","0,5,10,15,20,25,30,35,40,45,50,55","color","primary",3,"hourCycle","locale","ngModel","ngModelOptions","doneText","cancelText","ngModelChange"],["color","danger","expand","block",1,"ion-no-margin",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-content"),e._UZ(1,"app-toolbar"),e.TgZ(2,"ion-grid"),e.TgZ(3,"ion-row"),e.TgZ(4,"ion-col"),e._UZ(5,"app-card-title-bar",0),e.ALo(6,"translate"),e.TgZ(7,"ion-card",1),e.TgZ(8,"ion-card-content"),e.TgZ(9,"ion-grid",2),e.TgZ(10,"ion-row"),e.TgZ(11,"ion-col"),e.TgZ(12,"form",3),e.NdJ("ngSubmit",function(){return r.editProject()}),e.TgZ(13,"ion-item",1),e.TgZ(14,"ion-label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"ion-select",4),e.ALo(18,"translate"),e.ALo(19,"translate"),e.YNc(20,ne,2,2,"ion-select-option",5),e.ALo(21,"keyvalue"),e.ALo(22,"translate"),e.qZA(),e.qZA(),e.TgZ(23,"ion-item",1),e._UZ(24,"ion-input",6),e.ALo(25,"translate"),e.qZA(),e._UZ(26,"app-form-error",7),e.TgZ(27,"ion-item",1),e._UZ(28,"ion-textarea",8),e.ALo(29,"translate"),e.qZA(),e._UZ(30,"app-form-error",7),e.TgZ(31,"ion-item",1),e.TgZ(32,"ion-label",9),e._uU(33),e.ALo(34,"translate"),e.qZA(),e._UZ(35,"ion-input",10),e.qZA(),e._UZ(36,"app-form-error",7),e.TgZ(37,"ion-list"),e.TgZ(38,"ion-item",11),e.TgZ(39,"ion-label"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.qZA(),e.TgZ(42,"div",12),e.TgZ(43,"ion-grid",2),e.TgZ(44,"ion-row"),e.YNc(45,ae,17,30,"ng-container",13),e.TgZ(46,"ion-col"),e.TgZ(47,"ion-card",1),e.TgZ(48,"div"),e.TgZ(49,"ion-fab",14),e.TgZ(50,"ion-fab-button",15),e.NdJ("click",function(){return r.addTimeframe()}),e._UZ(51,"ion-icon",16),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(52,"br"),e._UZ(53,"hr"),e.qZA(),e.TgZ(54,"ion-list"),e.TgZ(55,"ion-item",11),e.TgZ(56,"ion-label"),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.qZA(),e.TgZ(59,"ion-item",1),e.TgZ(60,"ion-label"),e._uU(61),e.ALo(62,"translate"),e.qZA(),e._UZ(63,"ion-input",17),e.qZA(),e._UZ(64,"app-form-error",7),e.TgZ(65,"ion-item",1),e.TgZ(66,"ion-label"),e._uU(67),e.ALo(68,"translate"),e.qZA(),e._UZ(69,"ion-input",18),e.qZA(),e._UZ(70,"app-form-error",7),e.qZA(),e.TgZ(71,"ion-list"),e.TgZ(72,"ion-item",11),e.TgZ(73,"ion-label"),e._uU(74),e.ALo(75,"translate"),e.qZA(),e.qZA(),e.TgZ(76,"ion-item",1),e.TgZ(77,"ion-label"),e._uU(78),e.ALo(79,"translate"),e.qZA(),e._UZ(80,"ion-input",19),e.qZA(),e._UZ(81,"app-form-error",7),e.TgZ(82,"ion-item",1),e.TgZ(83,"ion-label"),e._uU(84),e.ALo(85,"translate"),e.qZA(),e._UZ(86,"ion-input",20),e.qZA(),e._UZ(87,"app-form-error",7),e.qZA(),e.TgZ(88,"div",21),e.TgZ(89,"ion-button",22),e._uU(90),e.ALo(91,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.s9C("title",e.lcZ(6,26,"ACTIONS.EDIT_PROJECT.title")),e.xp6(7),e.Q6J("formGroup",r.editProjectForm),e.xp6(3),e.Oqu(e.lcZ(16,28,"ACTIONS.EDIT_PROJECT.INPUT.topic")),e.xp6(2),e.s9C("okText",e.lcZ(18,30,"GENERAL.POPUPS.ok")),e.s9C("cancelText",e.lcZ(19,32,"GENERAL.POPUPS.cancel")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(21,34,e.lcZ(22,36,"GENERAL.PROJECT_TOPICS"))),e.xp6(4),e.s9C("placeholder",e.lcZ(25,38,"ACTIONS.EDIT_PROJECT.INPUT.title")),e.xp6(2),e.Q6J("errors",r.errorControl.title.errors),e.xp6(2),e.s9C("placeholder",e.lcZ(29,40,"ACTIONS.EDIT_PROJECT.INPUT.description")),e.xp6(2),e.Q6J("errors",r.errorControl.description.errors),e.xp6(3),e.Oqu(e.lcZ(34,42,"ACTIONS.EDIT_PROJECT.INPUT.cost")),e.xp6(3),e.Q6J("errors",r.errorControl.cost.errors),e.xp6(4),e.Oqu(e.lcZ(41,44,"ACTIONS.EDIT_PROJECT.INPUT.timeframe")),e.xp6(5),e.Q6J("ngForOf",r.timeframes),e.xp6(12),e.Oqu(e.lcZ(58,46,"ACTIONS.EDIT_PROJECT.INPUT.grade")),e.xp6(4),e.Oqu(e.lcZ(62,48,"ACTIONS.EDIT_PROJECT.INPUT.from")),e.xp6(3),e.Q6J("errors",r.errorControl.min_grade.errors),e.xp6(3),e.Oqu(e.lcZ(68,50,"ACTIONS.EDIT_PROJECT.INPUT.until")),e.xp6(3),e.Q6J("errors",r.errorControl.max_grade.errors),e.xp6(4),e.Oqu(e.lcZ(75,52,"ACTIONS.EDIT_PROJECT.INPUT.capacity")),e.xp6(4),e.Oqu(e.lcZ(79,54,"ACTIONS.EDIT_PROJECT.INPUT.from")),e.xp6(3),e.Q6J("errors",r.errorControl.min_participants.errors),e.xp6(3),e.Oqu(e.lcZ(85,56,"ACTIONS.EDIT_PROJECT.INPUT.until")),e.xp6(3),e.Q6J("errors",r.errorControl.max_participants.errors),e.xp6(2),e.Q6J("disabled",r.editProjectForm.invalid),e.xp6(1),e.Oqu(e.lcZ(91,58,"ACTIONS.EDIT_PROJECT.INPUT.submitButton")))},directives:[s.W2,te.n,s.jY,s.Nd,s.wI,ie.$,s.PM,s.FN,m._Y,m.JL,m.sg,s.Ie,s.Q$,s.t9,s.QI,m.JJ,m.u,P.sg,s.pK,s.j9,oe.A,s.g2,s.q_,s.IJ,s.W4,s.gu,s.as,s.YG,s.n0,s.x4,m.On],pipes:[v.X$,P.Nd],styles:[".addTimeframeCards[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{height:100%;min-height:100px}hr[_ngcontent-%COMP%]{background-color:#dedede}"]}),i})()}];let le=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[A.Bz.forChild(se)],A.Bz]}),i})();var ce=c(6453),me=c(6060);let de=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[P.ez,m.u5,s.Pc,le,ce.K,m.UX,v.aw.forChild({loader:{provide:v.Zw,useFactory:me.p,deps:[q.eN]}})]]}),i})()}}]);