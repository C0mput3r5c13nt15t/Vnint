{"version":3,"file":"src_app_pages_actions_project_view-projects_view-projects_module_ts.js","mappings":"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","sources":["./src/app/pages/actions/project/view-projects/view-projects.page.html","./src/app/pages/actions/project/view-projects/view-projects-routing.module.ts","./src/app/pages/actions/project/view-projects/view-projects.module.ts","./src/app/pages/actions/project/view-projects/view-projects.page.ts"],"sourcesContent":["export default \"<ion-content>\\n  <app-toolbar></app-toolbar>\\n  <ion-grid>\\n    <ion-row>\\n      <ion-col>\\n        <app-card-title-bar title=\\\"{{ 'ACTIONS.VIEW_PROJECTS.title' | translate }}\\\"></app-card-title-bar>\\n        <ion-card *ngIf=\\\"projects\\\" color=\\\"light\\\">\\n          <ion-card-content>\\n            <ion-grid class=\\\"inside-card-grid\\\">\\n              <ion-row>\\n                <ion-col>\\n                  <form [formGroup]=\\\"searchProjectForm\\\">\\n                    <ion-searchbar color=\\\"light\\\" (ionChange)=\\\"searchProject()\\\" placeholder=\\\"{{ 'ACTIONS.VIEW_PROJECTS.INPUT.searchProjectPlaceholder' | translate }}\\\" formControlName=\\\"title\\\" showCancelButton=\\\"focus\\\"></ion-searchbar>\\n                    <ion-select (ionChange)=\\\"searchProject()\\\" multiple=\\\"true\\\" formControlName=\\\"topic\\\" okText=\\\"{{ 'GENERAL.POPUPS.ok' | translate }}\\\" cancelText=\\\"{{ 'GENERAL.POPUPS.cancel' | translate }}\\\">\\n                      <ion-select-option *ngFor=\\\"let topic of ('GENERAL.PROJECT_TOPICS' | translate) | keyvalue\\\" value=\\\"{{ topic.key }}\\\">{{ topic.value }}</ion-select-option>\\n                    </ion-select>\\n                  </form>\\n                  <ng-container *ngIf=\\\"projects.length > 0\\\">\\n                    <ng-container *ngFor=\\\"let project of filteredProjects\\\">\\n                      <ion-card color=\\\"light\\\" button=true routerLink=\\\"/project/{{ project.id }}\\\" [disabled]=\\\"!permissions.includes('projects.toggle_authorized') && !project.authorized\\\">\\n                        <ion-card-header>\\n                          <ion-card-title>\\n                            {{ project.title }}\\n                          </ion-card-title>\\n                          <ion-card-subtitle>\\n                            <ion-label class=\\\"subtitle-labels\\\">{{ 'ACTIONS.VIEW_PROJECTS.by' | translate }} </ion-label>\\n                            <ion-label class=\\\"subtitle-labels\\\" color=\\\"primary\\\"><b>{{ project.leader.email }}</b></ion-label><br>\\n                            <ion-label class=\\\"subtitle-labels\\\">{{ 'ACTIONS.VIEW_PROJECTS.topic' | translate }} </ion-label>\\n                            <ng-container *ngFor=\\\"let topic of ('GENERAL.PROJECT_TOPICS' | translate) | keyvalue\\\">\\n                              <ion-label class=\\\"subtitle-labels\\\" color=\\\"primary\\\" *ngIf=\\\"project.topic == topic.key\\\"><b>{{ topic.value }}</b></ion-label>\\n                            </ng-container>\\n                          </ion-card-subtitle>\\n                          <ion-label class=\\\"long-description-label\\\">\\n                            {{ project.description }}\\n                          </ion-label>\\n                          <ion-card-subtitle>\\n                            <ion-badge color=\\\"danger\\\" *ngIf=\\\"permissions.includes('projects.toggle_authorized') && !project.authorized\\\"><ion-label class=\\\"white-font\\\">{{ 'ACTIONS.VIEW_PROJECTS.unauthorized' | translate }}</ion-label></ion-badge>\\n                            <ion-badge color=\\\"success\\\" *ngIf=\\\"permissions.includes('projects.toggle_authorized') && project.authorized\\\"><ion-label class=\\\"white-font\\\">{{ 'ACTIONS.VIEW_PROJECTS.authorized' | translate }}</ion-label></ion-badge>\\n                            <ion-badge color=\\\"light\\\" *ngIf=\\\"permissions.includes('preferences.store') && preference_ids.includes(project.id)\\\"><ion-label>{{ 'ACTIONS.VIEW_PROJECTS.isPreference' | translate }}</ion-label></ion-badge>\\n                          </ion-card-subtitle>\\n                        </ion-card-header>\\n                      </ion-card>\\n                    </ng-container>\\n                  </ng-container>\\n                  <ng-container *ngIf=\\\"projects.length == 0\\\">\\n                    <app-empty-card message=\\\"{{ 'ACTIONS.VIEW_PROJECTS.noProjects' | translate }}\\\"></app-empty-card><br>\\n                  </ng-container>\\n                </ion-col>\\n              </ion-row>\\n            </ion-grid>\\n          </ion-card-content>\\n        </ion-card>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ViewProjectsPage } from './view-projects.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ViewProjectsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ViewProjectsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\n\nimport { ViewProjectsPageRoutingModule } from './view-projects-routing.module';\nimport { ComponentsModule } from '../../../../components/components.module';\n\nimport { ViewProjectsPage } from './view-projects.page';\n\nimport {createTranslateLoader} from \"src/app/app.module\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ViewProjectsPageRoutingModule,\n    ComponentsModule,\n    ReactiveFormsModule,\n    TranslateModule.forChild({\n      loader: {\n        provide: TranslateLoader,\n        useFactory: createTranslateLoader,\n        deps: [HttpClient]\n      }\n    }),\n  ],\n  declarations: [ViewProjectsPage]\n})\nexport class ViewProjectsPageModule {}\n","import {Component, OnInit} from '@angular/core';\nimport {FormBuilder, FormGroup} from '@angular/forms';\nimport {Project} from 'src/app/interfaces/project';\nimport {ProjectService} from 'src/app/services/project.service';\nimport {Router} from '@angular/router';\nimport {AuthService} from 'src/app/services/auth.service';\nimport {User} from 'src/app/interfaces/user';\nimport {Preference} from 'src/app/interfaces/preference';\nimport {PreferencesService} from 'src/app/services/preference.service';\nimport {ErrorService} from 'src/app/services/error.service';\nimport {TranslateService} from \"@ngx-translate/core\";\nimport {AlertService} from \"../../../../services/alert.service\";\n\n@Component({\n  selector: 'app-view-projects',\n  templateUrl: './view-projects.page.html',\n  styleUrls: ['./view-projects.page.scss'],\n})\nexport class ViewProjectsPage implements OnInit {\n  searchProjectForm: FormGroup;\n  projects: Project[] = [];\n  user: User;\n  permissions: string[] = [];\n  preference_ids: Number[] = [];\n  preferences: Preference[];\n  filteredProjects: Project[] = [];\n\n  constructor(private projectService: ProjectService,\n              private formBuilder: FormBuilder,\n              private auth: AuthService,\n              private router: Router,\n              private preferencesService: PreferencesService,\n              private errorService: ErrorService,\n              private translate: TranslateService,\n              private alertService: AlertService) { }\n\n  ngOnInit() {\n    this.searchProjectForm = this.formBuilder.group({\n      topic: [['sports', 'nature', 'games', 'other']],\n      title: [''],\n    });\n  }\n\n  ionViewWillEnter() {\n    this.auth.authenticated().subscribe({\n      error: () => {\n        this.auth.setLoggedIn = false;\n        this.auth.setSessionExpired = true;\n        this.router.navigate(['/login']);\n      },\n      next: response => {\n        const resp: any = response;\n        if (resp.authenticated == false) {\n          this.auth.setLoggedIn = false;\n          this.auth.setSessionExpired = true;\n          this.router.navigate(['/login']);\n        } else {\n          this.user = resp.user;\n\n          this.auth.permissions().subscribe({\n            error: error => {\n              if (error.error.message == 'missingPermissions') {\n                this.alertService.alert(\"danger\", this.translate.instant('GENERAL.ERRORS.missingPermissions'), '', 'lock-closed');\n              } else {\n                this.errorService.errorOccurred.emit(error);\n              }\n            },\n            next: response => {\n              const resp: any = response;\n              this.permissions = [];\n              this.permissions = resp.permissions;\n\n              if (this.permissions.includes('preferences.show_associated')) {\n                this.getPreferences();\n              }\n            },\n          });\n        }\n      },\n    });\n    this.getProjects();\n  }\n\n  searchProject() {\n    this.filteredProjects = [];\n    this.projects.forEach(project => {\n      if (this.searchProjectForm.value.topic.includes(project.topic) && this.similar(project.title, this.searchProjectForm.value.title) > 0.3) {\n        this.filteredProjects.push(project);\n      }\n    });\n  }\n\n  similar(title, input) {\n    if (!input) {\n      return 1;\n    }\n\n    let equivalency = 0;\n    const minLength = (title.length > input.length) ? input.length : title.length;\n    const maxLength = (title.length < input.length) ? input.length : title.length;\n    for(let i = 0; i < minLength; i++) {\n        if(title[i] == input[i]) {\n            equivalency++;\n        }\n    }\n    return equivalency / maxLength;\n  }\n\n  getProjects() {\n    this.projectService.getProjects().subscribe({\n      error: error => {\n        this.errorService.errorOccurred.emit(error);\n      },\n      next: response => {\n        const resp: any = response;\n        this.projects = resp.projects;\n        this.filteredProjects = resp.projects;\n      },\n    });\n  }\n\n  getPreferences() {\n    this.preferencesService.getAssociatedPreferences().subscribe({\n      error: error => {\n        this.errorService.errorOccurred.emit(error);\n      },\n      next: response => {\n        const resp: any = response;\n        this.preferences = resp.preferences;\n        this.preference_ids = [];\n        resp.preferences.forEach(preference => {\n          this.preference_ids.push(preference.project_id);\n        });\n      },\n    });\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}