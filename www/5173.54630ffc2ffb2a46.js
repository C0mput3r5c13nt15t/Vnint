"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5173],{5173:(E,p,o)=>{o.r(p),o.d(p,{ManageUsersPageModule:()=>S});var g=o(6019),l=o(9133),u=o(4522),t=o(6990),m=o(6431),d=o(6952),e=o(3245);let f=(()=>{class s{constructor(r){this.http=r,this.headers=new u.WM({accept:"application/json",contentType:"application/json"}),this.options={this:this.headers,withCredentials:!0}}getUsers(){return this.http.get("/api/users",this.options)}}return s.\u0275fac=function(r){return new(r||s)(e.LFG(u.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var U=o(7094),Z=o(5729),A=o(6733),v=o(1516);function T(s,a){if(1&s&&(e.TgZ(0,"ion-select-option",8),e._uU(1),e.qZA()),2&s){const r=a.$implicit;e.s9C("value",r),e.xp6(1),e.Oqu(r)}}function P(s,a){if(1&s&&(e.ynx(0),e.TgZ(1,"ion-label",13),e.TgZ(2,"b"),e._uU(3),e.qZA(),e.qZA(),e.BQk()),2&s){const r=a.$implicit;e.xp6(3),e.hij("",r.name," ")}}function M(s,a){if(1&s&&(e.TgZ(0,"ion-card",1),e.TgZ(1,"ion-card-header"),e.TgZ(2,"ion-card-title",10),e._uU(3),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e.YNc(5,P,4,1,"ng-container",11),e.TgZ(6,"ion-label",12),e._uU(7),e.ALo(8,"date"),e.ALo(9,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&s){const r=a.$implicit;e.xp6(3),e.hij(" ",r.email," "),e.xp6(2),e.Q6J("ngForOf",r.roles),e.xp6(2),e.hij("- ",e.xi3(8,3,r.created_at,e.lcZ(9,6,"GENERAL.exactTimeDisplayFormat")),"")}}function C(s,a){if(1&s&&(e.ynx(0),e.YNc(1,M,10,8,"ion-card",9),e.BQk()),2&s){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.filteredUsers)}}const F=[{path:"",component:(()=>{class s{constructor(r,n,i,c){this.userService=r,this.formBuilder=n,this.rolesAndPermissionsService=i,this.errorService=c,this.users=[],this.filteredUsers=[],this.role_names=[]}ngOnInit(){this.searchUsersForm=this.formBuilder.group({roles:[""],email:[""]}),this.getRoles()}ionViewWillEnter(){this.getUsers(),this.getRoles()}getRoles(){this.rolesAndPermissionsService.getRoles().subscribe({error:r=>{this.errorService.errorOccurred.emit(r)},next:r=>{const n=r;this.role_names=[],this.role_names=n.roles.map(i=>i.name),this.searchUsersForm.patchValue({roles:n.roles.map(i=>i.name)})}})}getUsers(){this.userService.getUsers().subscribe({error:r=>{this.errorService.errorOccurred.emit(r)},next:r=>{const n=r;n.users.forEach(i=>{i.role_names=i.roles.map(c=>c.name)}),this.users=n.users,this.filteredUsers=n.users}})}searchUsers(){this.filteredUsers=[],this.users.forEach(r=>{this.arrayContainsArray(this.searchUsersForm.value.roles,r.role_names)&&this.similar(r.email,this.searchUsersForm.value.email)>.3&&this.filteredUsers.push(r)})}similar(r,n){if(!n)return 1;let i=0;const c=r.length>n.length?n.length:r.length,O=r.length<n.length?n.length:r.length;for(let h=0;h<c;h++)r[h]==n[h]&&i++;return i/O}arrayContainsArray(r,n){return n.every(function(i){return r.includes(i)})}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(f),e.Y36(l.qu),e.Y36(U.$),e.Y36(Z.T))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-manage-users"]],decls:20,vars:16,consts:[[3,"title"],["color","light"],[1,"inside-card-grid"],[3,"formGroup"],["color","light","formControlName","email","showCancelButton","focus",3,"placeholder","ionChange"],["multiple","","formControlName","roles",3,"okText","cancelText","placeholder","ionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["color","light",4,"ngFor","ngForOf"],[1,"user-email"],[4,"ngFor","ngForOf"],[1,"subtitle-labels"],["color","primary",1,"subtitle-labels"]],template:function(r,n){1&r&&(e.TgZ(0,"ion-content"),e._UZ(1,"app-toolbar"),e.TgZ(2,"ion-grid"),e.TgZ(3,"ion-row"),e.TgZ(4,"ion-col"),e._UZ(5,"app-card-title-bar",0),e.ALo(6,"translate"),e.TgZ(7,"ion-card",1),e.TgZ(8,"ion-card-content"),e.TgZ(9,"ion-grid",2),e.TgZ(10,"ion-row"),e.TgZ(11,"ion-col"),e.TgZ(12,"form",3),e.TgZ(13,"ion-searchbar",4),e.NdJ("ionChange",function(){return n.searchUsers()}),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"ion-select",5),e.NdJ("ionChange",function(){return n.searchUsers()}),e.ALo(16,"translate"),e.ALo(17,"translate"),e.YNc(18,T,2,2,"ion-select-option",6),e.qZA(),e.qZA(),e.YNc(19,C,2,1,"ng-container",7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(5),e.s9C("title",e.lcZ(6,8,"ACTIONS.MANAGE_USERS.title")),e.xp6(7),e.Q6J("formGroup",n.searchUsersForm),e.xp6(1),e.s9C("placeholder",e.lcZ(14,10,"ACTIONS.MANAGE_USERS.INPUT.searchUsersPlaceholder")),e.xp6(2),e.s9C("okText",e.lcZ(16,12,"GENERAL.POPUPS.ok")),e.s9C("cancelText",e.lcZ(17,14,"GENERAL.POPUPS.cancel")),e.s9C("placeholder",n.role_names),e.xp6(3),e.Q6J("ngForOf",n.role_names),e.xp6(1),e.Q6J("ngIf",n.users.length>0))},directives:[t.W2,A.n,t.jY,t.Nd,t.wI,v.$,t.PM,t.FN,l._Y,l.JL,l.sg,t.VI,t.j9,l.JJ,l.u,t.t9,t.QI,g.sg,g.O5,t.n0,t.Zi,t.Dq,t.tO,t.Q$],pipes:[m.X$,g.uU],styles:[".user-email[_ngcontent-%COMP%]{font-size:14pt}.subtitle-labels[_ngcontent-%COMP%]{font-size:12pt}"]}),s})()}];let x=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[d.Bz.forChild(F)],d.Bz]}),s})();var y=o(6453),N=o(6060);let S=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[g.ez,l.u5,t.Pc,x,y.K,l.UX,m.aw.forChild({loader:{provide:m.Zw,useFactory:N.p,deps:[u.eN]}})]]}),s})()}}]);