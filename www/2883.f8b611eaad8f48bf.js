"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2883],{2883:(Q,_,n)=>{n.r(_),n.d(_,{ViewProjectsPageModule:()=>R});var p=n(6019),a=n(9133),f=n(4522),s=n(6990),d=n(6431),h=n(6952),e=n(3245),P=n(1856),m=n(6898),Z=n(3271),T=n(5729),j=n(2677),x=n(6733),A=n(1516),v=n(2932);function C(o,i){if(1&o&&(e.TgZ(0,"ion-select-option",9),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.s9C("value",t.key),e.xp6(1),e.Oqu(t.value)}}function O(o,i){if(1&o&&(e.TgZ(0,"ion-label",13),e.TgZ(1,"b"),e._uU(2),e.qZA(),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.value)}}function b(o,i){if(1&o&&(e.ynx(0),e.YNc(1,O,3,1,"ion-label",17),e.BQk()),2&o){const t=i.$implicit,r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",r.topic==t.key)}}function I(o,i){1&o&&(e.TgZ(0,"ion-badge",18),e.TgZ(1,"ion-label",19),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ACTIONS.VIEW_PROJECTS.unauthorized")))}function E(o,i){1&o&&(e.TgZ(0,"ion-badge",20),e.TgZ(1,"ion-label",19),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ACTIONS.VIEW_PROJECTS.authorized")))}function S(o,i){1&o&&(e.TgZ(0,"ion-badge",2),e.TgZ(1,"ion-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ACTIONS.VIEW_PROJECTS.isPreference")))}function w(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"ion-card",11),e.TgZ(2,"ion-card-header"),e.TgZ(3,"ion-card-title"),e._uU(4),e.qZA(),e.TgZ(5,"ion-card-subtitle"),e.TgZ(6,"ion-label",12),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"ion-label",13),e.TgZ(10,"b"),e._uU(11),e.qZA(),e.qZA(),e._UZ(12,"br"),e.TgZ(13,"ion-label",12),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.YNc(16,b,2,1,"ng-container",10),e.ALo(17,"keyvalue"),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"ion-label",14),e._uU(20),e.qZA(),e.TgZ(21,"ion-card-subtitle"),e.YNc(22,I,4,3,"ion-badge",15),e.YNc(23,E,4,3,"ion-badge",16),e.YNc(24,S,4,3,"ion-badge",1),e.qZA(),e.qZA(),e.qZA(),e.BQk()),2&o){const t=i.$implicit,r=e.oxw(3);e.xp6(1),e.MGl("routerLink","/project/",t.id,""),e.Q6J("disabled",!r.permissions.includes("projects.toggle_authorized")&&!t.authorized),e.xp6(3),e.hij(" ",t.title," "),e.xp6(3),e.hij("",e.lcZ(8,11,"ACTIONS.VIEW_PROJECTS.by")," "),e.xp6(4),e.Oqu(t.leader.email),e.xp6(3),e.hij("",e.lcZ(15,13,"ACTIONS.VIEW_PROJECTS.topic")," "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(17,15,e.lcZ(18,17,"GENERAL.PROJECT_TOPICS"))),e.xp6(4),e.hij(" ",t.description," "),e.xp6(2),e.Q6J("ngIf",r.permissions.includes("projects.toggle_authorized")&&!t.authorized),e.xp6(1),e.Q6J("ngIf",r.permissions.includes("projects.toggle_authorized")&&t.authorized),e.xp6(1),e.Q6J("ngIf",r.permissions.includes("preferences.store")&&r.preference_ids.includes(t.id))}}function V(o,i){if(1&o&&(e.ynx(0),e.YNc(1,w,25,19,"ng-container",10),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.filteredProjects)}}function N(o,i){1&o&&(e.ynx(0),e._UZ(1,"app-empty-card",21),e.ALo(2,"translate"),e._UZ(3,"br"),e.BQk()),2&o&&(e.xp6(1),e.s9C("message",e.lcZ(2,1,"ACTIONS.VIEW_PROJECTS.noProjects")))}function J(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"ion-card",2),e.TgZ(1,"ion-card-content"),e.TgZ(2,"ion-grid",3),e.TgZ(3,"ion-row"),e.TgZ(4,"ion-col"),e.TgZ(5,"form",4),e.TgZ(6,"ion-searchbar",5),e.NdJ("ionChange",function(){return e.CHM(t),e.oxw().searchProject()}),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"ion-select",6),e.NdJ("ionChange",function(){return e.CHM(t),e.oxw().searchProject()}),e.ALo(9,"translate"),e.ALo(10,"translate"),e.YNc(11,C,2,2,"ion-select-option",7),e.ALo(12,"keyvalue"),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.YNc(14,V,2,1,"ng-container",8),e.YNc(15,N,4,3,"ng-container",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(5),e.Q6J("formGroup",t.searchProjectForm),e.xp6(1),e.s9C("placeholder",e.lcZ(7,7,"ACTIONS.VIEW_PROJECTS.INPUT.searchProjectPlaceholder")),e.xp6(2),e.s9C("okText",e.lcZ(9,9,"GENERAL.POPUPS.ok")),e.s9C("cancelText",e.lcZ(10,11,"GENERAL.POPUPS.cancel")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(12,13,e.lcZ(13,15,"GENERAL.PROJECT_TOPICS"))),e.xp6(3),e.Q6J("ngIf",t.projects.length>0),e.xp6(1),e.Q6J("ngIf",0==t.projects.length)}}const y=[{path:"",component:(()=>{class o{constructor(t,r,c,g,u,l,U,F){this.projectService=t,this.formBuilder=r,this.auth=c,this.router=g,this.preferencesService=u,this.errorService=l,this.translate=U,this.alertService=F,this.projects=[],this.permissions=[],this.preference_ids=[],this.filteredProjects=[]}ngOnInit(){this.searchProjectForm=this.formBuilder.group({topic:[["sports","nature","games","other"]],title:[""]})}ionViewWillEnter(){this.auth.authenticated().subscribe({error:()=>{this.auth.setLoggedIn=!1,this.auth.setSessionExpired=!0,this.router.navigate(["/login"])},next:t=>{const r=t;0==r.authenticated?(this.auth.setLoggedIn=!1,this.auth.setSessionExpired=!0,this.router.navigate(["/login"])):(this.user=r.user,this.auth.permissions().subscribe({error:c=>{"missingPermissions"==c.error.message?this.alertService.alert("danger",this.translate.instant("GENERAL.ERRORS.missingPermissions"),"","lock-closed"):this.errorService.errorOccurred.emit(c)},next:c=>{const g=c;this.permissions=[],this.permissions=g.permissions,this.permissions.includes("preferences.show_associated")&&this.getPreferences()}}))}}),this.getProjects()}searchProject(){this.filteredProjects=[],this.projects.forEach(t=>{this.searchProjectForm.value.topic.includes(t.topic)&&this.similar(t.title,this.searchProjectForm.value.title)>.3&&this.filteredProjects.push(t)})}similar(t,r){if(!r)return 1;let c=0;const g=t.length>r.length?r.length:t.length,u=t.length<r.length?r.length:t.length;for(let l=0;l<g;l++)t[l]==r[l]&&c++;return c/u}getProjects(){this.projectService.getProjects().subscribe({error:t=>{this.errorService.errorOccurred.emit(t)},next:t=>{const r=t;this.projects=r.projects,this.filteredProjects=r.projects}})}getPreferences(){this.preferencesService.getAssociatedPreferences().subscribe({error:t=>{this.errorService.errorOccurred.emit(t)},next:t=>{const r=t;this.preferences=r.preferences,this.preference_ids=[],r.preferences.forEach(c=>{this.preference_ids.push(c.project_id)})}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(P.Y),e.Y36(a.qu),e.Y36(m.e),e.Y36(h.F0),e.Y36(Z.y),e.Y36(T.T),e.Y36(d.sK),e.Y36(j.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-view-projects"]],decls:8,vars:4,consts:[[3,"title"],["color","light",4,"ngIf"],["color","light"],[1,"inside-card-grid"],[3,"formGroup"],["color","light","formControlName","title","showCancelButton","focus",3,"placeholder","ionChange"],["multiple","true","formControlName","topic",3,"okText","cancelText","ionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[4,"ngFor","ngForOf"],["color","light","button","true",3,"routerLink","disabled"],[1,"subtitle-labels"],["color","primary",1,"subtitle-labels"],[1,"long-description-label"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["class","subtitle-labels","color","primary",4,"ngIf"],["color","danger"],[1,"white-font"],["color","success"],[3,"message"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-content"),e._UZ(1,"app-toolbar"),e.TgZ(2,"ion-grid"),e.TgZ(3,"ion-row"),e.TgZ(4,"ion-col"),e._UZ(5,"app-card-title-bar",0),e.ALo(6,"translate"),e.YNc(7,J,16,17,"ion-card",1),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.s9C("title",e.lcZ(6,2,"ACTIONS.VIEW_PROJECTS.title")),e.xp6(2),e.Q6J("ngIf",r.projects))},directives:[s.W2,x.n,s.jY,s.Nd,s.wI,A.$,p.O5,s.PM,s.FN,a._Y,a.JL,a.sg,s.VI,s.j9,a.JJ,a.u,s.t9,s.QI,p.sg,s.n0,s.YI,h.rH,s.Zi,s.Dq,s.tO,s.Q$,s.yp,v.Y],pipes:[d.X$,p.Nd],styles:[".subtitle-labels[_ngcontent-%COMP%]{display:inline}.long-description-label[_ngcontent-%COMP%]{margin:0;display:block;overflow:hidden;flex:1;text-overflow:ellipsis;white-space:nowrap}ion-badge[_ngcontent-%COMP%]{margin-right:5px}ion-badge[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:normal!important}.white-font[_ngcontent-%COMP%]{color:#fff}"]}),o})()}];let L=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[h.Bz.forChild(y)],h.Bz]}),o})();var Y=n(6453),q=n(6060);let R=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[p.ez,a.u5,s.Pc,L,Y.K,a.UX,d.aw.forChild({loader:{provide:d.Zw,useFactory:q.p,deps:[f.eN]}})]]}),o})()}}]);